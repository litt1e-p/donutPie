var donutPie=function(t){"use strict";var e=require("d3");var n=function(t,e,n,i,r,a,s,o,c,l){"boolean"!=typeof s&&(c=o,o=s,s=!1);var u,d="function"==typeof n?n.options:n;if(t&&t.render&&(d.render=t.render,d.staticRenderFns=t.staticRenderFns,d._compiled=!0,r&&(d.functional=!0)),i&&(d._scopeId=i),a?(u=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,c(t)),t&&t._registeredComponents&&t._registeredComponents.add(a)},d._ssrRegister=u):e&&(u=s?function(){e.call(this,l(this.$root.$options.shadowRoot))}:function(t){e.call(this,o(t))}),u)if(d.functional){var h=d.render;d.render=function(t,e){return u.call(e),h(t,e)}}else{var f=d.beforeCreate;d.beforeCreate=f?[].concat(f,u):[u]}return n},i={name:"donutPie",props:{value:{type:Number,default:function(){return Number.prototype.constructor()}},data:{type:Number,default:function(){return Number.POSITIVE_INFINITY}},remark:{type:String,default:function(){return String.prototype.constructor()}},title:{type:String,default:function(){return String.prototype.constructor()}},conf:{type:Object,default:function(){return Object.prototype.constructor()}}},data:function(){return{className:"dnt-pie",anglesRange:.5*Math.PI,radius:0,pie:void 0,arc:void 0,bgArc:void 0,svg:void 0,chart:void 0,tooltip:void 0,oldVal:void 0,config:void 0}},created:function(){this.init()},mounted:function(){this.initGraph(),this.debounceInit(),this.draw()},methods:{debounceInit:function(){this.debouncTransitions=this.debounce(this.transitions,500)},init:function(){this.initClass(),this.initConf()},initClass:function(){this.className="pie-".concat(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7;return(16777215*Math.random()<<t).toString(16)}())},initConf:function(t){this.config=Object.assign({width:360,height:200,thickness:22,color:"#8888D3",bgColor:"#E9E9E9",percentColor:"#333333",titleColor:"rgba(0, 0, 0, 0.65)",disableCornerRadius:!1,titleTemplate:""},t||this.conf),this.radius=Math.min(this.config.width,this.config.height)/2,this.oldVal=0},initGraph:function(){var t=this.radius-this.config.thickness;this.arc=e.arc().innerRadius(t).outerRadius(this.radius).cornerRadius(this.disableCornerRadius?0:20).startAngle(-1*this.anglesRange).endAngle(-1*this.anglesRange),this.bgArc=e.arc().innerRadius(t).outerRadius(this.radius).cornerRadius(this.disableCornerRadius?0:20).startAngle(-1*this.anglesRange).endAngle(this.anglesRange),this.svg=e.select(".".concat(this.className)).append("svg").attr("width",this.config.width).attr("height",this.config.height),this.tooltip=e.select(".".concat(this.className)).append("div").attr("class","tooltip").style("display","none").style("position","absolute").style("text-align","center").style("line-height","30px").style("padding","3px 5px").style("box-shadow","rgba(0, 0, 0, 0.15) 0px 2px 12px").style("margin-top","-40px").style("font","12px sans-serif").style("background","#fff").style("pointer-events","none")},clear:function(){document.getElementsByClassName("charts").length&&this.svg.select(".charts").remove(),document.getElementsByClassName("legend").length&&this.svg.select(".legend").remove(),document.getElementsByClassName("arc").length&&this.svg.select(".arc").remove(),document.getElementsByClassName("bg-arc").length&&this.svg.select(".bg-arc").remove()},isNum:function(t){return/^\d+$/g.test(t.toString())},numberics:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!/^\d+$/g.test(t))return t;if(isNaN(t))return 0;var n=(""+t).length;if(n<7)return t;var i=Math.pow;return e=i(10,e),n-=n%3,Math.round(t*e/i(10,n))/e+" kMGTPE"[n/3]},draw:function(){var t=this,e=[this.value];t.charts=t.svg.selectAll("g").data(e).enter().append("g").attr("class","charts").attr("transform",t.translation(t.config.width/2,2*t.config.height/3));var n=t.svg.selectAll(".legend").data(e).enter().append("g").attr("class","legend").attr("transform",t.translation(-21,-21));document.querySelector(".".concat(this.className," .value-text"))?n.select(".value-text").text((function(){return""})):n.append("text").attr("class","value-text").attr("x",22).attr("y",12).attr("text-anchor","middle").attr("fill",t.config.percentColor||"#333").attr("transform",t.translation(t.config.width/2,2*t.config.height/3)).style("font-size","40px").style("font-weight","500").text((function(){return 0})),t.config.titleTemplate?t.svg.append("foreignObject").attr("class","fob").attr("width",t.config.width).attr("height",t.config.height).append("xhtml:div").attr("class","title-wrapper").style("font","14px 'Helvetica Neue'").html(t.config.titleTemplate):document.querySelector(".".concat(this.className," .title-text"))?n.select(".".concat(this.className," .title-text")).text((function(){return t.title||""})):n.append("text").attr("class","title-text").attr("x",22).attr("y",52).attr("text-anchor","middle").attr("fill",t.config.titleColor||"rgba(0, 0, 0, 0.65)").attr("transform",t.translation(t.config.width/2,2*t.config.height/3)).style("font-size","18px").style("font-weight","450").text((function(){return t.title||""})),t.charts.append("path").attr("class","bg-arc").attr("d",t.bgArc).attr("fill",t.config.bgColor),t.charts.append("path").attr("d",t.arc).attr("class","arc").attr("fill",t.config.color).on("mouseenter",(function(e){return t.arcTransition(t.arcHover,3)})).on("mousemove",(function(e){return t.tooltipHover(!0)})).on("mouseleave",(function(e){t.arcTransition(t.arcHover,0),t.tooltipHover(!1)})),t.$nextTick((function(){t.debouncTransitions()}))},transitions:function(){var t=this.data!==Number.POSITIVE_INFINITY?this.data:this.value;this.refreshTransition(),this.refreshTextTransition(t)},refreshTransition:function(){var t=this;this.svg.select("path.arc").data([this.value]).transition().duration(1500).attrTween("d",(function(e){return t.arcTween(e)}))},refreshTextTransition:function(t){var n=this,i=this.numberics(t,5),r=this.data===Number.POSITIVE_INFINITY?"%":"",a=e.select(".".concat(n.className)).select("text.value-text");!/(k|M|G|T|P|E)$/g.test(i.toString())&&n.isNum(i)?a.data([i]).transition().tween("text",(function(t){return n.textWeen(t,a)})).duration(1500):a.text(i+r)},textWeen:function(t,n){var i=this.data===Number.POSITIVE_INFINITY?"%":"",r=e.interpolateNumber(parseFloat(n.text()),t);return function(t){n.text(Math.round(r(t))+i)}},arcTween:function(t){var n=this,i=e.interpolate(-n.anglesRange+n.oldVal/100*2*n.anglesRange,-n.anglesRange+t/100*2*n.anglesRange);return function(t){return n.arc.endAngle(i(t)),n.arc(null)}},tooltipHover:function(t){this.remark&&this.tooltip.style("left",e.event.clientX-50+"px").style("top",e.event.offsetY+"px").style("display",t?"block":"none").html(t?this.remark:"")},arcTransition:function(t,e){this.charts.select(".arc").transition().duration(250).attrTween("d",(function(n){return t(e,n)}))},arcHover:function(t){var e=this,n=this.radius-this.config.thickness,i=t>0?n-t:n,r=t>0?t+this.radius:this.radius;return function(t){return e.arc.innerRadius(i),e.arc.outerRadius(r),e.arc(null)}},translation:function(t,e){return"translate(".concat(t,", ").concat(e,")")},refreshIfNeed:function(){var t=this;this.clear(),setTimeout((function(){t.draw()}),500)},debounce:function(t,e,n){var i;return function(){var r=this,a=arguments,s=n&&!i;clearTimeout(i),i=setTimeout((function(){i=null,n||t.apply(r,a)}),e),s&&t.apply(r,a)}}},watch:{value:function(t,e){this.oldVal=e,this.debouncTransitions()},data:function(t){this.debouncTransitions()},conf:{handler:function(t){this.initConf(t)},immediate:!0,deep:!0}}},r=function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"dnt-pie",class:t.className,staticStyle:{position:"relative"}})};r._withStripped=!0;var a=n({render:r,staticRenderFns:[]},undefined,i,"data-v-39dc67df",!1,undefined,void 0,void 0),s=[a],o=function(t){s.forEach((function(e){t.component(e.name,e)}))};return"undefined"!=typeof window&&window.Vue&&o(window.Vue),t.DonutPie=a,t.default=o,Object.defineProperty(t,"__esModule",{value:!0}),t}({});
