function normalizeComponent(t,e,n,i,s,r,a,o,l,c){"boolean"!=typeof a&&(l=o,o=a,a=!1);var d="function"==typeof n?n.options:n;t&&t.render&&(d.render=t.render,d.staticRenderFns=t.staticRenderFns,d._compiled=!0,s&&(d.functional=!0)),i&&(d._scopeId=i);var h;if(r?(h=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,l(t)),t&&t._registeredComponents&&t._registeredComponents.add(r)},d._ssrRegister=h):e&&(h=a?function(){e.call(this,c(this.$root.$options.shadowRoot))}:function(t){e.call(this,o(t))}),h)if(d.functional){var u=d.render;d.render=function(t,e){return h.call(e),u(t,e)}}else{var f=d.beforeCreate;d.beforeCreate=f?[].concat(f,h):[h]}return n}var d3=require("d3"),script={name:"donutPie",props:{value:{type:Number,default:function(){return 0}},remark:{type:String,default:function(){return String.prototype.constructor()}},title:{type:String,default:function(){return String.prototype.constructor()}},conf:{type:Object,default:function(){return{width:360,height:200,thickness:78,color:"#8888D3",bgColor:"#E9E9E9",disableCornerRadius:!1}}}},data(){return{anglesRange:.5*Math.PI,radius:0,pie:void 0,arc:void 0,bgArc:void 0,svg:void 0,chart:void 0,tooltip:void 0}},created(){this.initConf()},mounted(){this.initGraph(),this.draw()},methods:{init(){this.initConf(),this.initGraph()},initConf(){this.radius=Math.min(this.conf.width,this.conf.height)/2},initGraph(){var t=this;this.arc=d3.arc().innerRadius(this.conf.thickness).outerRadius(this.radius).cornerRadius(this.disableCornerRadius?0:20).startAngle(-1*this.anglesRange).endAngle(function(e){return-t.anglesRange+e/100*2*t.anglesRange}),this.bgArc=d3.arc().innerRadius(this.conf.thickness).outerRadius(this.radius).cornerRadius(this.disableCornerRadius?0:20).startAngle(-1*this.anglesRange).endAngle(this.anglesRange),this.svg=d3.select(".dnt-pie").append("svg").attr("width",this.conf.width).attr("height",this.conf.height),this.tooltip=d3.select(".dnt-pie").append("div").attr("class","tooltip").style("display","none").style("position","absolute").style("text-align","center").style("line-height","30px").style("padding","3px 5px").style("box-shadow","rgba(0, 0, 0, 0.15) 0px 2px 12px").style("margin-top","-40px").style("font","12px sans-serif").style("background","#fff").style("pointer-events","none")},refrech(){document.getElementsByClassName("charts").length&&this.svg.select(".charts").remove(),document.getElementsByClassName("legend").length&&this.svg.select(".legend").remove(),document.getElementsByClassName("arc").length&&this.svg.select(".arc").remove(),document.getElementsByClassName("bg-arc").length&&this.svg.select(".bg-arc").remove()},draw(){var t=this,e=[this.value],n=Math.round(this.value)+"%";this.charts=this.svg.selectAll("g").data(e).enter().append("g").attr("class","charts").attr("transform",this.translation(this.conf.width/2,2*this.conf.height/3));var i=this.svg.selectAll(".legend").data(e).enter().append("g").attr("class","legend").attr("transform",this.translation(-21,-21));document.getElementsByClassName("value-text").length?i.select(".value-text").text(function(){return n||""}):i.append("text").attr("class","value-text").attr("x",22).attr("y",12).attr("text-anchor","middle").attr("fill","#333").attr("transform",this.translation(this.conf.width/2,2*this.conf.height/3)).style("font-size","40px").style("font-weight","500").text(function(){return n}),document.getElementsByClassName("title-text").length?i.select(".title-text").text(function(){return t.title||""}):i.append("text").attr("class","title-text").attr("x",22).attr("y",52).attr("text-anchor","middle").attr("fill","rgba(0, 0, 0, 0.65)").attr("transform",this.translation(this.conf.width/2,2*this.conf.height/3)).style("font-size","18px").style("font-weight","450").text(function(){return t.title||""}),this.charts.append("path").attr("class","bg-arc").attr("d",this.bgArc).attr("fill",this.conf.bgColor),this.charts.append("path").attr("d",this.arc).attr("class","arc").attr("fill",this.conf.color).on("mouseenter",function(e){return t.arcTransition(t.arcHover,3)}).on("mousemove",function(e){return t.tooltipHover(!0)}).on("mouseleave",function(e){t.arcTransition(t.arcHover,0),t.tooltipHover(!1)})},tooltipHover(t){this.remark&&this.tooltip.style("left",d3.event.pageX-50+"px").style("top",d3.event.pageY-70+"px").style("display",t?"inline-block":"none").html(t?this.remark:"")},arcTransition(t,e){this.charts.select(".arc").transition().duration(250).attr("d",t(e))},arcHover(t){var e=this,n=t>0?this.conf.thickness-t:this.conf.thickness,i=t>0?t+this.radius:this.radius,s=d3.arc().innerRadius(n).outerRadius(i).cornerRadius(this.disableCornerRadius?0:20).startAngle(-1*this.anglesRange).endAngle(function(t){return-e.anglesRange+t/100*2*e.anglesRange});return this.arc=s,s},translation(t,e){return`translate(${t}, ${e})`}},watch:{value(t){var e=this;this.refrech(),setTimeout(function(){e.draw()},500)}}},normalizeComponent_1=normalizeComponent;const __vue_script__=script;var __vue_render__=function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"dnt-pie",staticStyle:{position:"relative"}})},__vue_staticRenderFns__=[];__vue_render__._withStripped=!0;const __vue_inject_styles__=void 0,__vue_scope_id__="data-v-6b2f44a8",__vue_module_identifier__=void 0,__vue_is_functional_template__=!1;var Main=normalizeComponent_1({render:__vue_render__,staticRenderFns:__vue_staticRenderFns__},void 0,__vue_script__,__vue_scope_id__,!1,void 0,void 0,void 0),components=[Main],install=function(t){components.forEach(function(e){t.component(e.name,e)})};"undefined"!=typeof window&&window.Vue&&install(window.Vue);export default install;export{Main as DonutPie};
